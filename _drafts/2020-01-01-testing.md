---
layout: post
post_title: Testing
categories: blog
tags: management tech
excerpt: TODO
---

Tests never fail to make me feel like a bad developer. Unit tests in particular. I just can't wrap my brain around it. There seems to be a smell for it and I swear I get it wrong every single time. Unit tests should test the barest, smallest pieces of logic yes? Feels like when I try to do that I get feedback that the test has no value.
Please ignore some of the other weirdness in this function :sweat_smile: some of it is company patterns, or WIP. But -
 I have a function that
receives a callback
returns an object
one of the object properties is a function which runs the callback
so I wrote a test that confirms the callback is run when the return object's execute property is triggered. It felt overly simple when I was writing it, but isn't that the point of a unit test? Feedback from my teammate is that it doesn't add value. (edited) 
Screenshot 2025-01-17 at 3.46.56 pm.png
 
Screenshot 2025-01-17 at 3.46.56 pm.png

testing is super subjective, norms have changed over time and vary between companies/teams/individuals anyway

i feel like the vibe has moved on from comprehensive unit tests for every micro-piece of functionality

but it depends who you talk to...
:see_no_evil:
1
:100:
1
this isn't the first time I've gotten this feedback, so it always feels like a me problem

personally, I decide whether and what to test based on: if it's complicated

also this is an opinion some people might disagree with, but i think the names and categories of tests are not very helpful or clear.
everything is a test of some unit of functionality (the subject under test) but not other bits of functionality (things naturally outside the scope, things that could have been in it but you're mocking/stubbing)

unit vs integration tests isn't really as natural a grouping when you start to consider how wide your unit could be. you can test whatever you want really

none of that might help you a lot, but if there are team or codebase norms, or you can ask code reviewers what they want to see, i'd do that :smile:

yeah, I feel like in frontend it's also gotten blurrier with react-testing-library. previously anything with user interaction was an integration test, but now it can be written as a unit. I'm looking at our integration test scripts and they're near-identical to some RTL tests I've written. (the difference is more in how they're wired up, but the point stands)

One of the philosophies I like is unit tests as documentation. If a function isn't immediately clear what it's doing, or takes several arguments that return a number of potential outcomes, then you use that to document what you expect to happen/not happen

i write tests in some cases:
it's cumbersome to test manually because it involves a lot of steps (usually not unit tests)
it's a complex algorithm and if i optimise it for one scenario i need a test suite to make sure i haven't broken other scenarios (still not unit tests)

createLoadTemplatePreview is essentially a factory, it puts a bunch of things together in a static way without any conditions. Low level tests on factories are low value because every higher level test that uses that factory is testing the same logic.
If someone changed createLoadTemplatePreview
in a way that broke the call to the callback then the higher level tests would all catch that mistake.
The same would be true for a test that checked that teamplatePreview.getIcon() returns ZoomInIcon
Since tests cost time to update when code changes there is an argument that really simple test like this just creates extra work without providing additional confidence.
:bulb:
1
:heavy_plus_sign:
1
Unfortunately, I agree with your teammate, but I'd amend the feedback to "it doesn't add enough value to merit a test, where the test adds lines of code & more things to change if the underlying code needs changing"

Also, this is what I think of as "glue" code. Glue code should be covered by integration, not unit tests. The tricky bits in glue code are what is being glued together across multiple domains that would have their own unit tests - so trying to write unit tests around them usually ends up with lots of bad mocks & difficult to change code.

You can definitely find people with long beards who will swear that these kinds of tests are necessary, and that if you're having trouble with them it's because you're not being a diligent enough developer, but we don't listen to them any more.

Happy to receive the feedback! I think I just get frustrated by my inability to spot the right answer. These are great ways of thinking about it.

+1 for unit tests in frontend code not being particularly useful unless you're wanting to test out something specifically edge-casey like a regex or parsing in general

or something that tkaes a lot of steps, like a multi-page form submission (edited) 

I would argue that is not a unit test

ah true

RTL is absolutely an integration testing library IMO, and often has overlap with more e2e suites, but when you use which is a little more subtle

My approach is:
Regular jest for edge-cases, complex fn's and self-documentation, no expectation of great coverage numbers
RTL by default for testing out full components / pages / features, generally should have pretty good coverage
Playwright for testing specific complex interactions across pages, and for making sure things break when other teams change APIs that we rely on without telling us when types can't enforce that

Playwright for visual regression tests as well, again only as needed where you want to catch people making unexpected changes

playwright is good for multi-user tests as well - e.g. create a post, check it's read-only by other users